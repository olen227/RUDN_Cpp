# Makefile - файл сборки для проекта банковской системы
# Использует компилятор g++ для сборки исходных файлов C++

CXX = g++             # Переменная CXX содержит имя компилятора C++
CXXFLAGS = -std=c++17 -Wall -Wextra -O2 # Опции компилятора: используем стандарт C++17, включаем предупреждения и оптимизацию

SRC_DIR = src         # Папка с исходниками
OBJ_DIR = build       # Папка для объектных файлов
INCLUDE_DIR = include # Папка с заголовочными файлами

SOURCES = $(wildcard $(SRC_DIR)/*.cpp) # Находим все cpp-файлы в папке src
OBJECTS = $(patsubst $(SRC_DIR)/%.cpp,$(OBJ_DIR)/%.o,$(SOURCES)) # Определяем имена объектных файлов для каждого cpp

TARGET = bank_system  # Имя конечного исполняемого файла

.PHONY: all clean     # Специальные цели, которые не являются файлами

all: $(TARGET)        # Цель по умолчанию: собираем исполняемый файл

$(TARGET): $(OBJECTS) # Зависит от всех объектных файлов
	$(CXX) $(CXXFLAGS) -o $@ $^ # Команда линковки: собираем объектные файлы в исполняемый файл

$(OBJ_DIR)/%.o: $(SRC_DIR)/%.cpp | $(OBJ_DIR) # Правило для сборки объектного файла из исходника
	$(CXX) $(CXXFLAGS) -I$(INCLUDE_DIR) -c $< -o $@ # Компилируем исходный файл с указанием папки include

$(OBJ_DIR):           # Правило для создания папки build (если её нет)
	mkdir -p $(OBJ_DIR) # Создаём папку build

clean:                # Цель для очистки результатов сборки
	rm -rf $(OBJ_DIR) $(TARGET) # Удаляем папку build и исполняемый файл