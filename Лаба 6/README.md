# Лабораторная работа №6: Работа с базами данных в C++

## Описание
Реализация системы управления студентами и оценками с использованием SQLite3.

## Структура проекта
```
lab6/
├── include/             # Заголовочные файлы
│   ├── DatabaseManager.h
│   ├── StudentRepository.h
│   └── InputValidator.h
├── src/                 # Файлы реализации
│   ├── DatabaseManager.cpp
│   ├── StudentRepository.cpp
│   ├── InputValidator.cpp
│   └── main.cpp
├── Makefile
└── README.md
```

## Установка зависимостей

### Ubuntu/Debian:
```bash
sudo apt-get install libsqlite3-dev
```

### macOS:
```bash
brew install sqlite3
```

## Компиляция
```bash
make
```

## Запуск
```bash
./university_db
```

## Реализованные задания

### Задание 1: Базовая настройка
✓ Класс DatabaseManager для управления подключением
✓ Создание таблиц students и grades
✓ Оптимизация настроек БД (WAL mode, индексы)

### Задание 2: CRUD операции
✓ Все операции: addStudent, getStudent, updateStudent, deleteStudent
✓ Использование подготовленных выражений (prepared statements)
✓ Проверка уникальности email
✓ Обработка ошибок целостности данных

### Задание 3: Транзакции и сложные запросы
✓ Метод addStudentWithGrades() с транзакциями
✓ Запросы с JOIN для получения связанных данных
✓ Методы статистики: getStudentsByGroup, getAverageGradeBySubject, getTopStudents
✓ Обработка ошибок транзакций с откатом (ROLLBACK)

### Задание 4: Безопасность
✓ Класс InputValidator для валидации всех входных данных
✓ Проверка формата email (regex)
✓ Защита от SQL-инъекций
✓ Проверка диапазона оценок (0-100)
✓ Валидация формата группы (XX-YYY)

### Задание 5: Оптимизация
✓ Пакетная вставка (batchInsertStudents) с транзакциями
✓ Индексы на полях: email, group_name, subject, student_id
✓ Измерение производительности
✓ Демонстрация работы с 100+ записями

## Функциональность

### Основные возможности:
- Добавление, редактирование, удаление студентов
- Управление оценками
- Поиск студентов по группе
- Вычисление средней оценки по предмету
- Получение рейтинга лучших студентов
- Пакетная вставка данных
- Атомарные операции через транзакции

### Безопасность:
- Защита от SQL-инъекций через prepared statements
- Валидация всех входных данных
- Проверка формата email
- Ограничение длины полей

### Оптимизация:
- WAL журнал для лучшей производительности
- Индексы для часто используемых запросов
- Пакетная вставка для больших объемов данных
- Настройка кэша и синхронизации

## Примечания
- Каждая строка кода прокомментирована
- Код упрощен для лучшего понимания
- База данных создается автоматически при первом запуске
- Файл БД: university.db
